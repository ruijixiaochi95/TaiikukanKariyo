<div class="container pb-5">
  <% @gyms.each do |gym| %>
    <div class="row justify-content-center border border-warning rounded rounded-3 mb-3">
      <div class="col-md-4">
        <%= image_tag gym.get_image(300, 300), class: 'rounded my-2' %>
      </div>
      <div class="col-md-4">
        <%= link_to gym_path(gym.id) do %>
          <h5 class="py-2 mt-3"><strong>&ensp;<%= gym.name %></strong></h5>
        <% end %>
        <i class="fas fa-map-marker-alt"></i>
        <%= gym.address %><br>
        <%= link_to gym_path(gym.id) do %>
          <i class="fas fa-info-circle"></i>詳細
        <% end %><br>
        コメント数:<%= gym.gym_comments.count %>
        <div id="average_rating_<%= gym.id %>"></div>
        <script>
          $(document).on('turbolinks:load', function() {
            let elem = document.querySelector('#average_rating_<%= gym_gym_comment.id %>');
            if (elem == null) return;

            elem.innerHTML = "";
            let opt = {
              starOn: "<%= asset_path('star-on.png') %>",
              starOff: "<%= asset_path('star-off.png') %>",
              starHalf: "<%= asset_path('star-half.png') %>",
              score: <%= @average_ratings[gym_gym_comment.id].to_f.round(2) if @average_ratings[gym_gym_.id].present? %>,
              readOnly: true,
            };
            raty(elem, opt);
          });
        </script>
      </div>
    </div>
  <% end %>
</div>
