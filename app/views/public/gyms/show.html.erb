<div class="container py-5">
  <div class="row">
    <div class="col-5">
      <%= image_tag @gym.get_image(500,300) %>
    </div>
    <div class="col-4">
      <h5 class="pt-4"><%= @gym.name %></h5>
      <%= @gym.postal_code %><br>
      <%= @gym.address %><br>
      <%= @gym.phone_number %><br>
      <%= @gym.caption %>
    </div>
    <% @gym.facilities.each do |facility| %>
    <%= facility.name %>
    <% end %>

    <div class="map">
      <div id="map" style="width: 300px; height: 300px;"></div>
    </div>
  </div>
  <%= link_to "予約する", gym_facilities_path(@gym.id) %>
</div>

<script type="text/javascript">
  function initMap() {
    var test ={lat: <%= @gym.latitude %>, lng: <%= @gym.longitude %>};
    var map = new google.maps.Map(document.getElementById('map'), {
                  zoom: 15,
                  center: test
                  });
    var transitLayer = new google.maps.TransitLayer();
      transitLayer.setMap(map);

    var contentString = '住所：<%= @gym.address %>';
    var infowindow = new google.maps.InfoWindow({
        content: contentString
    });
    var marker = new google.maps.Marker({
                 position:test,
                 map: map,
                 title: contentString
    });

    marker.addListener('click', function() {
    infowindow.open(map, marker);
  });
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['API_KEY'] %>&callback=initMap" async defer></script>
